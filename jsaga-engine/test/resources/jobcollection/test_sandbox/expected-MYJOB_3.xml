<?xml version="1.0" encoding="UTF-8"?>
<ext:Job xmlns:ext="http://www.in2p3.fr/jsdl-extension">
    <ext:JobLifetimeManagement>
        <ext:Retry count="3" maxTime="PT80S" status="queued"/>
        <ext:Retry count="2" maxTime="PT6M" status="running"/>
        <ext:Retry count="1" status="failed"/>
    </ext:JobLifetimeManagement>
    <JobDefinition xmlns="http://schemas.ggf.org/jsdl/2005/11/jsdl">
        <JobDescription>
            <JobIdentification>
                <JobName>MYJOB_3</JobName>
            </JobIdentification>
            <Application>
                <posix:POSIXApplication xmlns:posix="http://schemas.ggf.org/jsdl/2005/11/jsdl-posix">
                    <posix:Executable>$E</posix:Executable>
                    <posix:Argument>-c0 $C0</posix:Argument>
                    <posix:Argument>-c1 $C1</posix:Argument>
                    <posix:Argument>-c2 $C2</posix:Argument>
                    <posix:Input>$D</posix:Input>
                    <posix:Output>$R</posix:Output>
                    <posix:Error>$STDERR</posix:Error>
                </posix:POSIXApplication>
            </Application>
            <Resources>
                <FileSystem name="IntermediaryDirectory">
                    <FileSystemType>spool</FileSystemType>
                    <MountPoint>$INTERMERIADY_DIR</MountPoint>
                </FileSystem>
                <FileSystem name="ApplicationsDirectory">
                    <FileSystemType>normal</FileSystemType>
                    <MountPoint>$APPLICATIONS_DIR</MountPoint>
                </FileSystem>
                <FileSystem name="WorkingDirectory">
                    <FileSystemType>temporary</FileSystemType>
                    <MountPoint>$PWD</MountPoint>
                </FileSystem>
                <FileSystem name="HELLOWORLD_1.1">
                    <FileSystemType>normal</FileSystemType>
                    <MountPoint>$APPLICATIONS_DIR/HelloWorld/1.1</MountPoint>
                </FileSystem>
            </Resources>
            <DataStaging name="INPUT_SANDBOX">
                <FileName>input-sandbox.tar</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <Source>
                    <URI>gsiftp://defaultSE.openplast.fr/tmp/test_sandbox.in/input-sandbox.tar#OpenPlast</URI>
                </Source>
                <ext:Step uri="file:///tmp/test_sandbox/input-sandbox.tar">
                    <ext:Step uri="gsiftp://defaultSE.openplast.fr/tmp/test_sandbox.in/input-sandbox.tar#OpenPlast"/>
                </ext:Step>
                <ext:Shared>true</ext:Shared>
            </DataStaging>
            <DataStaging name="C0">
                <FileName>$PWD/config0.cfg</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/file.,,,tmp,config0.cfg</URI>
                </Source>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="C1">
                <FileName>$PWD/config1.cfg</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/srb.,,sreynaud@host2.5544,grid,config1.cfg</URI>
                </Source>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="C2">
                <FileName>$PWD/config2.cfg</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/http.,,host5.8080,public,configuration,config2.cfg</URI>
                </Source>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="E">
                <FileName>$APPLICATIONS_DIR/HelloWorld/1.1/bin/executable.exe</FileName>
                <FilesystemName>$APPLICATIONS_DIR/HelloWorld/1.1</FilesystemName>
                <CreationFlag>dontOverwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source/>
                <ext:CopyLocally>false</ext:CopyLocally>
                <ext:Shared>true</ext:Shared>
            </DataStaging>
            <DataStaging name="E">
                <FileName>$PWD/executable-src/bin/executable.exe</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/gsiftp.,,host3.2811,repository,src,executable-src.tar.gz</URI>
                    <ext:Process>tar xzvf $SOURCE ; cd executable-src ; make</ext:Process>
                </Source>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="D">
                <FileName>$PWD/data.dat</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/gsiftp.,,host4.2811,data,data_3.dat</URI>
                </Source>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="R">
                <FileName>$PWD/result.dat</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Target>
                    <URI>tar://$OUTPUT_SANDBOX/mail.,,sreynaud@in2p3.fr,result_3.dat</URI>
                </Target>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="STDERR">
                <FileName>$PWD/stderr.txt</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Target>
                    <URI>tar://$OUTPUT_SANDBOX/file.,,,tmp,stderr_3.txt</URI>
                </Target>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="OUTPUT_SANDBOX">
                <FileName>output-sandbox.tar</FileName>
                <FilesystemName>$PWD</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <Target>
                    <URI>gsiftp://closeSE.openplast.fr:2811/intermediary/test_sandbox.out/MYJOB_3/output-sandbox-3.tar#OpenPlast</URI>
                </Target>
                <ext:Step uri="file:///tmp/test_sandbox/output-sandbox-3.tar">
                    <ext:Step uri="gsiftp://closeSE.openplast.fr:2811/intermediary/test_sandbox.out/MYJOB_3/output-sandbox-3.tar#OpenPlast"/>
                </ext:Step>
                <ext:Shared>false</ext:Shared>
            </DataStaging>
        </JobDescription>
    </JobDefinition>
</ext:Job>
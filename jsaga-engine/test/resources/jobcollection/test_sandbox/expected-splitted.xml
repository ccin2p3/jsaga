<?xml version="1.0" encoding="UTF-8"?>
<ext:Job xmlns:ext="http://www.in2p3.fr/jsdl-extension">
    <ext:JobLifetimeManagement>
        <ext:Retry count="3" maxTime="PT80S" status="queued"/>
        <ext:Retry count="2" maxTime="PT6M" status="running"/>
        <ext:Retry count="1" status="failed"/>
    </ext:JobLifetimeManagement>
    <JobDefinition xmlns="http://schemas.ggf.org/jsdl/2005/11/jsdl">
        <JobDescription>
            <JobIdentification>
                <JobName>MYJOB_3</JobName>
            </JobIdentification>
            <Application>
                <posix:POSIXApplication xmlns:posix="http://schemas.ggf.org/jsdl/2005/11/jsdl-posix">
                    <posix:Executable>$E</posix:Executable>
                    <posix:Argument>-c0 $C0</posix:Argument>
                    <posix:Argument>-c1 $C1</posix:Argument>
                    <posix:Argument>-c2 $C2</posix:Argument>
                    <posix:Input>$D</posix:Input>
                    <posix:Output>$R</posix:Output>
                    <posix:Error>$STDERR</posix:Error>
                </posix:POSIXApplication>
            </Application>
            <Resources>
                <FileSystem name="HelloWorldDirectory">
                    <FileSystemType>normal</FileSystemType>
                    <MountPoint>HelloWorld/1.1</MountPoint>
                    <ext:ParentFilesystemName>ApplicationsDirectory</ext:ParentFilesystemName>
                    <ext:Tag>HELLOWORLD_1.1</ext:Tag>
                </FileSystem>
                <FileSystem name="HelloWorldDirectory">
                    <FileSystemType>normal</FileSystemType>
                    <MountPoint>HelloWorld/1.2</MountPoint>
                    <ext:ParentFilesystemName>ApplicationsDirectory</ext:ParentFilesystemName>
                    <ext:Tag>HELLOWORLD_1.2</ext:Tag>
                </FileSystem>
            </Resources>
            <DataStaging name="INPUT_SANDBOX">
                <FileName>input-sandbox.tar</FileName>
                <CreationFlag>overwrite</CreationFlag>
                <Source>
                    <URI>file:///tmp/test_sandbox/input-sandbox.tar</URI>
                </Source>
                <ext:Shared>true</ext:Shared>
            </DataStaging>
            <DataStaging name="C0">
                <FileName>config0.cfg</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/file.,,,tmp,config0.cfg</URI>
                </Source>
                <ext:Step uri="file:///tmp/config0.cfg">
                    <ext:Step uri="tar:///tmp/test_sandbox/input-sandbox.tar/file.,,,tmp,config0.cfg"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="C1">
                <FileName>config1.cfg</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/https.,,host2.8443,private,configuration,config1.cfg</URI>
                </Source>
                <ext:Step uri="https://host2:8443/private/configuration/config1.cfg#TEST_X509">
                    <ext:Step uri="tar:///tmp/test_sandbox/input-sandbox.tar/https.,,host2.8443,private,configuration,config1.cfg"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="C2">
                <FileName>config2.cfg</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/http.,,host5.8080,public,configuration,config2.cfg</URI>
                </Source>
                <ext:Step uri="http://host5:8080/public/configuration/config2.cfg">
                    <ext:Step uri="tar:///tmp/test_sandbox/input-sandbox.tar/http.,,host5.8080,public,configuration,config2.cfg"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="E">
                <FileName>bin/executable.exe</FileName>
                <FilesystemName>HelloWorldDirectory</FilesystemName>
                <CreationFlag>dontOverwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source/>
                <ext:CopyLocally>false</ext:CopyLocally>
                <ext:Shared>true</ext:Shared>
            </DataStaging>
            <DataStaging name="E">
                <FileName>executable-src/bin/executable.exe</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/gsiftp.,,host3.2811,repository,src,executable-src.tar.gz</URI>
                    <ext:Process>tar xzvf $@ ; cd executable-src ; make</ext:Process>
                </Source>
                <ext:Step uri="gsiftp://host3:2811/repository/src/executable-src.tar.gz#EGEE_proxy">
                    <ext:Step uri="tar:///tmp/test_sandbox/input-sandbox.tar/gsiftp.,,host3.2811,repository,src,executable-src.tar.gz"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="D">
                <FileName>data.dat</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Source>
                    <URI>tar://$INPUT_SANDBOX/gsiftp.,,host4.2811,data,data_3.dat</URI>
                </Source>
                <ext:Step uri="gsiftp://host4:2811/data/data_3.dat#OpenPlast_proxy">
                    <ext:Step uri="tar:///tmp/test_sandbox/input-sandbox.tar/gsiftp.,,host4.2811,data,data_3.dat"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="R">
                <FileName>result.dat</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Target>
                    <URI>tar://$OUTPUT_SANDBOX/mail.,,sreynaud@in2p3.fr,result_3.dat</URI>
                </Target>
                <ext:Step uri="mail://sreynaud@in2p3.fr/result_3.dat?host1">
                    <ext:Step uri="tar:///tmp/test_sandbox/output-sandbox-3.tar/mail.,,sreynaud@in2p3.fr,result_3.dat"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="STDERR">
                <FileName>stderr.txt</FileName>
                <FilesystemName>WorkingDirectory</FilesystemName>
                <CreationFlag>overwrite</CreationFlag>
                <DeleteOnTermination>true</DeleteOnTermination>
                <Target>
                    <URI>tar://$OUTPUT_SANDBOX/file.,,,tmp,stderr_3.txt</URI>
                </Target>
                <ext:Step uri="file:///tmp/stderr_3.txt">
                    <ext:Step uri="tar:///tmp/test_sandbox/output-sandbox-3.tar/file.,,,tmp,stderr_3.txt"/>
                </ext:Step>
                <ext:CopyLocally>false</ext:CopyLocally>
            </DataStaging>
            <DataStaging name="OUTPUT_SANDBOX">
                <FileName>output-sandbox.tar</FileName>
                <CreationFlag>overwrite</CreationFlag>
                <Target>
                    <URI>file:///tmp/test_sandbox/output-sandbox-3.tar</URI>
                </Target>
                <ext:Shared>false</ext:Shared>
            </DataStaging>
        </JobDescription>
    </JobDefinition>
</ext:Job>